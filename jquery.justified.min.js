!function(t,i,h,e){"use strict";var o="justifiedImages";function s(i,h){this.element=i,this.$el=t(i),this._name=o,this.init(h)}s.prototype={defaults:{template:function(t){return'<div class="photo-container" style="height:'+t.displayHeight+"px;margin-right:"+t.marginRight+'px;"><img class="image-thumb" src="'+t.src+'" style="width:'+t.displayWidth+"px;height:"+t.displayHeight+'px;" ></div>'},appendBlocks:function(){return[]},rowHeight:150,maxRowHeight:350,handleResize:!1,margin:1,imageSelector:"image-thumb",imageContainer:"photo-container"},init:function(i){this.options=t.extend({},this.defaults,i),this.displayImages(),this.options.handleResize&&this.handleResize()},getBlockInRow:function(t){for(var i=this.options.appendBlocks(),h=0;h<i.length;h++){var e=i[h];if(e.rowNum===t)return e}},displayImages:function(){var h=this,e=[],o=0,s=0,n=this.options.images.length,a=this.options.images,r=[],p=0,d=this.options.appendBlocks(),l=i.devicePixelRatio,g=this.$el.width(),c=parseInt(this.options.margin,10),f=this.$el,m=parseInt(this.options.rowHeight,10);t.each(this.options.images,function(t,i){var o=h.options.getSize(i),s=parseInt(o.width,10),n=parseInt(o.height,10);n!==m&&(s=Math.floor(s*(m/n))),p+=s,e.push(s)}),t.each(d,function(t,i){p+=i.width});for(var w=p/Math.ceil(p/g)/l,u=0;s<n;){var v={width:0,photos:[]},y=0,R=this.getBlockInRow(r.length+1);for(R&&(v.width+=R.width,u+=R.width);u+e[s+y]/2<=w*(r.length+1)&&s+y<n;)u+=e[s+y],v.width+=e[s+y],v.photos.push({width:e[s+y],photo:a[s+y]}),y++;s+=y,r.push(v)}for(var x=0;x<r.length;x++){v=r[x];var I=!1;if(o=x+1,this.options.maxRows&&o>this.options.maxRows)break;x===r.length-1&&(I=!0),u=-1*c;var b=this.getBlockInRow(I?-1:o),k=g;b&&(k-=b.width,u=0);var H=k/v.width,B=(y=v.photos.length,Math.min(Math.floor(m*H),parseInt(this.options.maxRowHeight,10)));H=B/this.options.rowHeight;var M=t("<div/>",{class:"picrow"});M.height(B+c),f.append(M);for(var j="",z=0;z<v.photos.length;z++){var C=v.photos[z].photo,S=Math.floor(v.photos[z].width*H);u+=S+c,j+=this.renderPhoto(C,{src:this.options.thumbnailPath(C,S,B),width:S,height:B},!b&&z===v.photos.length-1)}if(""!==j){if(M.html(j),Math.abs(u-k)<.05*k){for(var P=0;u<k;){var $=M.find("."+this.options.imageContainer+":nth-child("+(P+1)+")").find("."+this.options.imageSelector);$.width($.width()+1),P=(P+1)%y,u++}for(P=0;u>k;){var _=M.find("."+this.options.imageContainer+":nth-child("+(P+1)+")").find("."+this.options.imageSelector);_.width(_.width()-1),P=(P+1)%y,u--}}else if(k-u>.05*k)for(var O=k-u,W=0,q=M.find("."+this.options.imageContainer),A=0,N=0;N<q.length;N++){var Q=O/q.length,T=q.eq(N).find("."+this.options.imageSelector),D=T.width(),E=T.height();x===q.length-1&&(Q=O-W),T.width(D+Q),T.height(E/D*(D+Q)),A=(E-T.height())/2,T.css("margin-top",A),W+=Q}b&&t("<div />",{class:this.options.imageContainer+" added-block",css:{width:b.width,height:B},html:b.html}).appendTo(M)}else M.remove()}},renderPhoto:function(i,h,e){var o,s={};return o=t.extend({},i,{src:h.src,displayWidth:h.width,displayHeight:h.height,marginRight:e?0:this.options.margin}),this.options.dataObject?s[this.options.dataObject]=o:s=o,this.options.template(s)},handleResize:function(){},refresh:function(i){this.options=t.extend({},this.defaults,i),this.$el.empty(),this.displayImages()}},t.fn[o]=function(i){var h,e=arguments;return this.each(function(){var n=t(this),a=t.data(this,"plugin_"+o),r="object"==typeof i&&i;a?"string"==typeof i?h=a[i].apply(a,Array.prototype.slice.call(e,1)):a.refresh.call(a,r):n.data("plugin_"+o,a=new s(this,r))}),h||this}}(jQuery,window,document);
